{ 
    "uriRules": [
        {
            "priority": 1,
            "uriPattern": "/public*",
            "requestType": "*",
            "allowedUsers": "'*'"
        },
        {
            "priority": 2,
            "uriPattern": "/storage*",            
            "requestType": "*",
            "allowedRoles": "'test-app/admin'"
        },
        {
            "priority": 1,
            "uriPattern": "/storage*",
            "requestType": "READ",
            "queryParamsCondition": "resourceParams.value('q') != null && resourceParams.value('q').contains('\\\"user\\\":\\\"' + $securityContext.subject + '\\\"')",
            "allowedRoles": "'test-app/user'"
        },
        {
            "priority": 1,
            "uriPattern": "/storage*",
            "requestType": "CREATE,UPDATE",
            "queryParamsCondition": "$requestState.getProperty('user') ==  $securityContext.subject",
            "allowedRoles": "'test-app/user'"
        },
        {
            "priority": 1,
            "uriPattern": "/app*",
            "requestType": "CREATE,UPDATE,DELETE",
            "allowedRoles": "'test-app/admin'"
        },
        {
            "priority": 1,
            "uriPattern": "/app*",
            "requestType": "READ",
            "allowedRoles": "'test-app/admin','test-app/user'"
        }
    ]
}